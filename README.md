# Alexandru Stoica - Personal Website & Blog

This repository contains the source code for the personal website and blog of Alexandru Stoica, Software Engineer. The site serves as a portfolio, blog platform, recommendation display, and contact point.

**Live Demo:** [https://www.alexandrustoica.dev/](https://www.alexandrustoica.dev/)

## Technologies Used

This project leverages a combination of modern web technologies chosen for flexibility, performance, and maintainability:

* **Backend:** Node.js with the Express.js framework for routing and server logic.
* **Templating:** Embedded JavaScript (EJS) for server-side rendering of HTML pages.
* **Database:** PostgreSQL (hosted on Supabase for production).
* **ORM:** Sequelize for object-relational mapping, simplifying database interactions.
* **Frontend:**
    * Vanilla JavaScript for client-side interactions (navigation, theme switching, consent management).
    * CSS3 with Custom Properties (Variables) for flexible styling and theming.
    * Particles.js for a lightweight, theme-aware animated background.
    * Prism.js for client-side syntax highlighting in blog posts.
* **Environment:** `dotenv` for managing environment variables.
* **Security/Validation Middleware:** `helmet`, `cookie-parser`, `express-rate-limit`, `express-validator`.
* **Build Tools:** `clean-css-cli` and `terser` (managed via npm scripts) for CSS and JavaScript minification.

## Features

* **Responsive Design:** Mobile-first approach ensuring usability across various screen sizes.
* **Dynamic Light/Dark Theme:** User preference is detected, applied instantly server-side (via Cookies) to prevent flashing, saved in `localStorage` (as fallback), and can be toggled client-side. Prism.js theme also adapts automatically.
* **Blog Platform:**
    * Dynamically lists blog posts fetched from the database.
    * Displays individual blog posts with full content.
    * Supports formatted content including code blocks (with Prism.js syntax highlighting), images, quotes, etc.
    * Calculated "Time to read" and session-based "View count" displayed per post.
* **Recommendations/Reviews System:**
    * Displays approved recommendations on a dedicated page.
    * Allows users to submit new recommendations via a form.
    * Submissions saved with `pending` status for manual moderation.
    * Includes backend validation (`express-validator`), rate limiting (`express-rate-limit`), and a honeypot field for spam prevention.
    * Dedicated "Thank You" page after submission.
    * *(Note: Email notification for pending reviews is not currently implemented).*
* **Cookie Consent Banner:** Informs users about cookie usage and manages consent for non-essential cookies (Theme preference, Google Analytics).
* **Animated Background:** Uses `particles.js` initialized with theme-appropriate colors.
* **SEO Enhancements:** Dynamic page titles, per-post meta descriptions, JSON-LD Schema (Person & BlogPosting), dynamic `sitemap.xml` route, and `robots.txt`.
* **Security Measures:** Implements `helmet` for security headers (including configured CSP), secure flags for cookies, environment variables for credentials, relies on Sequelize's protection against SQL injection.
* **Contact Page:** Displays contact information.
* **CV Download:** Link to download the CV PDF.

## Project Structure

The project follows a standard MVC-like pattern:

* `/`: Contains main configuration files (`package.json`, `.gitignore`, `.env` template).
* `server.js`: The main application entry point, sets up Express, middleware, and routes.
* `database.js`: Configures the Sequelize database connection (PostgreSQL/SQLite fallback).
* `/routes`: Contains Express route handlers (`index.js`, `blog.js`, `reviews.js`).
* `/models`: Defines Sequelize data models (`Post.js`, `Review.js`).
* `/views`: Contains EJS templates, including:
    * `/partials`: Reusable template fragments (`header.ejs`, `footer.ejs`).
    * Page templates (`index.ejs`, `blog.ejs`, `post-detail.ejs`, `contact.ejs`, `reviews.ejs`, `review-thank-you.ejs`, `privacy-policy.ejs`).
* `/public`: Contains static assets served directly to the client:
    * `/css`: Source stylesheets (`style.css`).
    * `/js`: Source client-side JavaScript (`theme.js`, `nav.js`, `consent.js`, `particles-init.js`).
    * `/images`: Site images (favicon, avatar, blog images).
    * `/dist`: Contains **minified** CSS/JS assets generated by the build process (used in production).
    * Other static files (`robots.txt`, CV PDF).
* `/data`: (Optional, for SQLite) Contains the `database.sqlite` file during local development.

## Key Implementation Highlights

### SEO

* **Dynamic Metadata:** Page titles and meta descriptions (for blog posts) generated dynamically.
* **Structured Data:** JSON-LD schema for `Person` and `BlogPosting`.
* **Crawling & Indexing:** Dynamic `/sitemap.xml` route and `robots.txt`.
* **URL Structure:** Currently uses slugs blog post URLs (`/blog/:slug`)

### Performance

* **Theme Flash Prevention:** Robust server-side cookie method with client-side `localStorage` fallback and immediate inline script check prevents FOUC.
* **Asset Minification:** An `npm run build` script uses `clean-css-cli` and `terser` to minify CSS and JS assets into the `/public/dist/` directory. Production environments link to these minified files.
* **Optimized Script Loading:** Client-side JavaScript loaded at the end of `<body>`.
* **Efficient Background:** Uses theme-aware `particles.js`.
* **Server-Side:** HTTP compression (`compression` middleware) and static asset caching (`express.static`).

### Security

* **HTTP Headers:** `helmet` middleware sets security headers, including a configured Content Security Policy allowing necessary CDNs.
* **Cookie Security:** Session and Theme cookies use `SameSite=Lax` and `Secure` flags (in production). Theme cookie setting respects user consent.
* **Credentials:** Database credentials managed via environment variables (`.env`).
* **Submission Security:** Review submission uses CSRF protection (implicitly via standard form POST, consider adding explicit CSRF tokens for higher security), rate limiting (`express-rate-limit`), a honeypot field, and server-side validation/sanitization (`express-validator`).
* **Dependencies:** Regular checks using `npm audit` are recommended.

### Code Clarity & Maintainability

* **Modular Structure:** Clear separation of concerns.
* **Theming:** CSS Custom Properties enable easy light/dark theme management and dynamic Prism.js theme switching.
* **Code Reusability:** EJS partials for header/footer.

## Setup & Running Locally

1.  **Clone:** `git clone <your-repo-url>` / `cd <your-repo-directory>`
2.  **Install:** `npm install`
3.  **Environment:** Create `.env` file (see `.env.example` or structure below) and add `DATABASE_URL` (optional for SQLite fallback) and `BASE_URL=http://localhost:3000`. You will also need a `SESSION_SECRET`.
    ```dotenv
    # Example .env for local dev (using SQLite fallback)
    # DATABASE_URL=
    SESSION_SECRET=generate_a_strong_local_secret_here
    BASE_URL=http://localhost:3000
    # GA_MEASUREMENT_ID=G-XXXXXXXXXX # Optional for local testing
    # EMAIL_... variables needed only if implementing email notifications
    ```
4.  **Database Setup:** The `sequelize.sync({ force: false })` in `server.js` will create `database.sqlite` in `/data` and the necessary tables (`Posts`, `Reviews`) on first run if `DATABASE_URL` is not set. If using PostgreSQL locally, ensure the DB exists and set `DATABASE_URL`.
5.  **Start:** `npm start`
6.  **Access:** `http://localhost:3000` (or your configured port).

## Deployment (Render)

* **Build Command:** Set to `npm run build` in Render settings. Render automatically runs `npm install` first.
* **Start Command:** Set to `npm start`.
* **Environment Variables:** Set `NODE_ENV=production`, `DATABASE_URL` (pointing to Supabase), `SESSION_SECRET` (use a strong, unique secret), `BASE_URL` (your production `https://...` URL), `GA_MEASUREMENT_ID`, and any email credentials in the Render service environment settings.
* **Dependencies:** `clean-css-cli` and `terser` were moved to `dependencies` in `package.json` to ensure availability in the Render build environment.
* **HTTPS:** Ensure Render is configured to serve over HTTPS.
* **Database Migrations:** For robust production deployments, consider replacing `sequelize.sync()` with Sequelize migrations (`sequelize-cli`) managed as part of your deployment workflow.

## License

ISC License

Copyright (c) 2025, Alexandru Stoica

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.